<!doctype html>
<html lang="pt-br" xmlns:th="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Ativar AGENTE IA</title>
    <meta th:if="${pending}" http-equiv="refresh" content="3">
    <style>
        body { font-family: Arial, sans-serif; background:#0b0f1a; color:#fff; margin:0; padding:24px; }
        .card { max-width:720px; margin:0 auto; background:#111a2e; border:1px solid #1f2b4a; border-radius:14px; padding:20px; }
        .muted { color:#b7c2dd; }
        .qr { margin-top:18px; display:flex; justify-content:center; }
        img { max-width:340px; border-radius:12px; border:1px solid #2a3a63; }
        .status { margin-top:12px; }
    </style>
</head>
<body>
<div class="card">
    <h2>Ativação do AGENTE IA</h2>
    <p class="muted">Order: <b th:text="${orderId}"></b></p>

    <div th:if="${pending}">
        <p th:text="${pendingMessage}">Estamos preparando seu QR Code. Aguarde alguns segundos…</p>
        <p class="muted">Expira em: <span th:text="${expiresAt}"></span></p>
    </div>

    <div th:if="${!pending}">
        <p>Abra o WhatsApp → Aparelhos conectados → <b>Conectar</b> e escaneie o QR abaixo.</p>
        <div class="qr">
            <img th:if="${qrUrl != null}" th:src="${qrUrl}" alt="QR Code"/>
            <img th:if="${qrUrl == null and qrBase64 != null}" th:src="${'data:image/png;base64,' + qrBase64}" alt="QR Code"/>
        </div>
        <div class="status">
            <p class="muted">Expira em: <span th:text="${expiresAt}"></span></p>
        </div>
    </div>
</div>
</body>
</html>